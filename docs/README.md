# Инструкция по автоматизации учета ответов турнира ЧГК
Для автоматизации учета ответов используется две программы. Первая - “Генератор бланков ответов ЧГК” позволяет сформировать бланки ответов со штрих-кодами. Вторая - таблица учета ответов.

## Использование генератора бланков
Генератор бланков - windows приложение, позволяющее сформировать бланки ответов со штрих-кодами. Окно программы имеет следующий вид:

![Генератор бланков ЧГК](https://raw.githubusercontent.com/Stuw/ChGKAutomation/master/docs/images/%D0%9E%D0%BA%D0%BD%D0%BE%20%D0%B3%D0%B5%D0%BD%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%B0%20%D0%B1%D0%BB%D0%B0%D0%BD%D0%BA%D0%BE%D0%B2.png)

### Формирование бланков
Для создания бланков необходимо указать:
* количество туров,
* количество вопросов в туре,
* диапазон номеров команд
* принтер, который будет использоваться для печати бланков,
* вариант размещения бланков (матрица 3 на 6 или матрица 4 на 9). 

Далее следует нажать кнопку “Печатать бланки”. Для сохранения бланков в файл можно использовать принтер “Microsoft XPS Document Writer”, который сохраняет бланки в формате [XPS](http://ru.wikipedia.org/wiki/XML_Paper_Specification).  

Программа формирует бланки следующего вида:

![Бланк ответов](https://raw.githubusercontent.com/Stuw/ChGKAutomation/master/docs/images/%D0%B1%D0%BB%D0%B0%D0%BD%D0%BA%20%D0%BE%D1%82%D0%B2%D0%B5%D1%82%D0%B0.gif)

На каждом бланке указывается
* Номер тура.
* Номер вопроса в туре.
* Номер команды.
* Сквозной номер вопроса в турнире.
* Штрих-код содержащий шестизначное число, где первые две цифры - номер тура, далее двузначный номер вопроса в туре, далее двузначный номер команды. Формат штрих-кода [Code 128](http://ru.wikipedia.org/wiki/Code_128). 


Штрих-код может быть считан большинством бюджетных сканеров. Для тестирования использовался сканер CipherLab 1000, как один из наиболее доступных. При выборе сканера в первую очередь обращайте внимание на поддержку фармата штрих-кода [Code 128](http://ru.wikipedia.org/wiki/Code_128).

### Получение таблицы учета
Генератор бланков позволяет получить шаблон таблицы учета. Для этого следует нажать кнопку “Сохранить таблицу учета”.
Настройки генератора никак не влияют на содержимое таблицы, сохраняется всегда один и тот же шаблон.

## Использование таблицы учета
Таблица учета представляет собой таблицу в формате ODF, которая может быть открыта с помощью [Open Office](https://www.openoffice.org/ru/about-downloads.html) Calc. Скачать и использовать пакет Open Office можно бесплатно.

Работа с таблицей в других редакторах таблиц предусмотрена только в режиме просмотра.

Внимание, таблица учета использует макросы для формирования таблиц и обработки ввода со штрих-сканера. Для корректной работы программы необходимо разрешить исполнение неподписаных макросов. Для этого необходимо открыть
“Сервис>Параметры>Безопасность>Безопасность макросов” и перевести ползунок в положение “Низкий”.


Таблица учета результатов игры ЧГК позволяет автоматизировать:
* ввод результатов с бланков с помощью сканера штрих-кодов,
* формирование итоговой таблицы. 


### Предварительная настройка
* Укажите количество туров и количество вопросов в туре.
* Не трогайте ячейку "Количество команд". Она заполняется автоматически.
* Заполните список команд. Номер команды должен быть уникальным числом, он обязателен к заполнению.
* Укажите, используется ли дополнительный параметр для разделения мест. На данный момент поддерживается только разделение по рейтингу вопросов. Если дополнительный параметр не используется, места в итоговой таблице будут разделены между командами, набравшими одинаковое количество очков.
* В колонке «Спецзачет» поставьте символ «Х» или “да” напротив команд, участвующих в дополнительном зачете, например в зачете этапа кубка России. Для таких команд в итоговой таблице будет выведено место в спец-зачете в отдельной колонке.
* Нажмите кнопку "Создать турнир". В результате будет созданы страницы с учетом результатов в турах и страница с итоговыми результатами. 


### Ввод результатов
* Откройте страницу соответствующего тура.
* Убедитесь, что выделена красная ячейка над таблицей.
* Произведите считывание штрих-кода с бланка, содержащего правильный ответ. В таблице в соответствующей ячейке появится цифра 1 и ячейка будет закрашена серым. Рядом с красной ячейкой появится надпись с указанием номера команды и номера ответа.
* В случае необходимости допускается ручное проставление признака правильного ответа (цифры 1) в таблице. После этого необходимо поместить курсор обратно в красную ячейку.
* Известная проблема: использование комбинации клавиш “Ctrl+Z” в некоторых случаях может привести к сбоям в работе программы, после чего автоматическое проставление признака корректности ответов перестает работать. Постарайтесь избегать использования отмены операции при работе с таблицей учета. 

![Ввод результатов](https://raw.githubusercontent.com/Stuw/ChGKAutomation/master/docs/images/%D0%B2%D0%B2%D0%BE%D0%B4%20%D1%80%D0%B5%D0%B7%D1%83%D0%BB%D1%8C%D1%82%D0%B0%D1%82%D0%BE%D0%B2.png)

### Расчет результатов
Для расчета предварительных результатов после каждого тура или окончательных результатов перейдите на первую страницу таблицы учета и нажмите кнопку “Пересчитать результаты”. Формирование таблицы может занимать до минуты на больших списках. После завершения формирования итоговой таблицы появится соответствующее сообщение.

![Итоговая таблица](https://raw.githubusercontent.com/Stuw/ChGKAutomation/master/docs/images/%D0%B8%D1%82%D0%BE%D0%B3%D0%BE%D0%B2%D0%B0%D1%8F%20%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0.png)

ОСТОРОЖНО: кнопка “Удалить турнир” удалит все результаты по турам. Будьте осторожны!
